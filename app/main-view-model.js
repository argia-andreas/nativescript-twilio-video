"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = require("data/observable");
var http = require("http");
var nativescript_twilio_video_1 = require("nativescript-twilio-video");
var timer = require("timer");
var permissions = require('nativescript-permissions');
var HelloWorldModel = (function (_super) {
    __extends(HelloWorldModel, _super);
    function HelloWorldModel(page) {
        var _this = _super.call(this) || this;
        _this.page = page;
        _this.videoActivity = new nativescript_twilio_video_1.VideoActivity();
        _this.getPermissions();
        _this.set('participant', 'wow');
        var self = _this;
        return _this;
    }
    HelloWorldModel.prototype.getPermissions = function () {
        permissions.requestPermissions([
            android.Manifest.permission.RECORD_AUDIO,
            android.Manifest.permission.CAMERA
        ], "I need these permissions because I'm cool")
            .then(function (response) {
        })
            .catch(function (e) {
            console.dir(e);
            console.log("Uh oh, no permissions - plan B time!");
        });
    };
    HelloWorldModel.prototype.show_local_video = function () {
        this.videoActivity.createAudioAndVideoTracks();
    };
    HelloWorldModel.prototype.toggle_local_video = function () {
        this.videoActivity.toggle_local_video();
    };
    HelloWorldModel.prototype.set_access_token = function (token, name) {
        this.videoActivity.set_access_token(token, name);
    };
    HelloWorldModel.prototype.connect_to_room = function (room) {
        this.videoActivity.connect_to_room('a');
    };
    return HelloWorldModel;
}(observable_1.Observable));
exports.HelloWorldModel = HelloWorldModel;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi12aWV3LW1vZGVsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibWFpbi12aWV3LW1vZGVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsOENBQTJDO0FBRzNDLElBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUUzQix1RUFBMEQ7QUFJMUQsSUFBSSxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0FBQzdCLElBQUksV0FBVyxHQUFHLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBS3REO0lBQXFDLG1DQUFVO0lBVTNDLHlCQUFvQixJQUFVO1FBQTlCLFlBQ0ksaUJBQU8sU0FzRVY7UUF2RW1CLFVBQUksR0FBSixJQUFJLENBQU07UUFFMUIsS0FBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLHlDQUFhLEVBQUUsQ0FBQztRQUN6QyxLQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDdEIsS0FBSSxDQUFDLEdBQUcsQ0FBQyxhQUFhLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDL0IsSUFBSSxJQUFJLEdBQUcsS0FBSSxDQUFDOztJQWtFcEIsQ0FBQztJQUlELHdDQUFjLEdBQWQ7UUFFSSxXQUFXLENBQUMsa0JBQWtCLENBQUM7WUFDM0IsT0FBTyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsWUFBWTtZQUN4QyxPQUFPLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxNQUFNO1NBQ2pDLEVBQUUsMkNBQTJDLENBQUM7YUFDOUMsSUFBSSxDQUFDLFVBQUMsUUFBUTtRQUNmLENBQUMsQ0FBQzthQUNELEtBQUssQ0FBQyxVQUFDLENBQUM7WUFDTCxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2YsT0FBTyxDQUFDLEdBQUcsQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO1FBQ3hELENBQUMsQ0FBQyxDQUFDO0lBQ1gsQ0FBQztJQUdNLDBDQUFnQixHQUF2QjtRQUVJLElBQUksQ0FBQyxhQUFhLENBQUMseUJBQXlCLEVBQUUsQ0FBQztJQUVuRCxDQUFDO0lBRU0sNENBQWtCLEdBQXpCO1FBRUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBRTVDLENBQUM7SUFFTSwwQ0FBZ0IsR0FBdkIsVUFBd0IsS0FBYSxFQUFFLElBQVk7UUFFL0MsSUFBSSxDQUFDLGFBQWEsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFFckQsQ0FBQztJQUdNLHlDQUFlLEdBQXRCLFVBQXVCLElBQVk7UUFDL0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7SUFVNUMsQ0FBQztJQUdMLHNCQUFDO0FBQUQsQ0FBQyxBQXJJRCxDQUFxQyx1QkFBVSxHQXFJOUM7QUFySVksMENBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge09ic2VydmFibGV9IGZyb20gJ2RhdGEvb2JzZXJ2YWJsZSc7XG5pbXBvcnQgeyBQYWdlIH0gZnJvbSAndWkvcGFnZSc7XG5pbXBvcnQgKiBhcyBhcHAgZnJvbSBcInRucy1jb3JlLW1vZHVsZXMvYXBwbGljYXRpb25cIjtcbnZhciBodHRwID0gcmVxdWlyZShcImh0dHBcIik7XG5cbmltcG9ydCB7IFZpZGVvQWN0aXZpdHkgfSBmcm9tICduYXRpdmVzY3JpcHQtdHdpbGlvLXZpZGVvJztcblxuXG5cbnZhciB0aW1lciA9IHJlcXVpcmUoXCJ0aW1lclwiKTtcbnZhciBwZXJtaXNzaW9ucyA9IHJlcXVpcmUoJ25hdGl2ZXNjcmlwdC1wZXJtaXNzaW9ucycpO1xuXG5cblxuXG5leHBvcnQgY2xhc3MgSGVsbG9Xb3JsZE1vZGVsIGV4dGVuZHMgT2JzZXJ2YWJsZSB7XG4gICAgdmlkZW9BY3Rpdml0eTogVmlkZW9BY3Rpdml0eTtcbiAgICAvLyBnYW1lIG1vZGUgcmVhZCBteSBsaXBzXG4gICAgcHJpdmF0ZSBsb2NhbFZpZGVvOiBhbnk7XG4gICAgcHJpdmF0ZSBhY2Nlc3NUb2tlbjogc3RyaW5nO1xuICAgIHByaXZhdGUgcm9vbU5hbWU6IHN0cmluZztcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xuICAgIHByaXZhdGUgaGVyb3M6IGFueTtcbiAgICBwdWJsaWMgcGFydGljaXBhbnQ6IGFueTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGFnZTogUGFnZSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLnZpZGVvQWN0aXZpdHkgPSBuZXcgVmlkZW9BY3Rpdml0eSgpO1xuICAgICAgICB0aGlzLmdldFBlcm1pc3Npb25zKCk7XG4gICAgICAgIHRoaXMuc2V0KCdwYXJ0aWNpcGFudCcsICd3b3cnKTtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIC8vIHRoaXMudmlkZW9BY3Rpdml0eS52aWRlb0V2ZW50Lm9uKCdvbkNvbm5lY3RlZCcsIChkYXRhKSA9PiB7XG4gICAgICAgIC8vICAgICBsZXQgcGFydGljaXBhbnRzID0gZGF0YS5vYmplY3RbJ3Jvb20nXS5nZXRQYXJ0aWNpcGFudHMoKTtcbiAgICAgICAgLy8gICAgIGxldCBzdHJpbmcgPSBkYXRhLm9iamVjdC5zdHJpbmc7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhzdHJpbmcpO1xuICAgICAgICAvLyAgICAgdGhpcy5zZXQoJ3BhcnRpY2lwYW50Jywgc3RyaW5nKTtcbiAgICAgICAgLy8gICAgIGZvciAodmFyIGkgPSAwLCBsID0gcGFydGljaXBhbnRzLnNpemUoKTsgaSA8IGw7IGkrKykge1xuXG4gICAgICAgIC8vICAgICAgICAgdmFyIHBhcnRpY2lwYW50ID0gcGFydGljaXBhbnRzLmdldChpKTtcbiAgICAgICAgLy8gICAgICAgICB0aGlzLnBhcnRpY2lwYW50ID0gcGFydGljaXBhbnQuZ2V0SWRlbnRpdHkoKTtcbiAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnBhcnRpY2lwYW50LCAnIGlzIGEgJywgdHlwZW9mIHRoaXMucGFydGljaXBhbnQpO1xuICAgICAgICAvLyAgICAgICAgIHRoaXMuc2V0KCdwYXJ0aWNpcGFudCcsIFN0cmluZyhwYXJ0aWNpcGFudC5nZXRJZGVudGl0eSgpKSk7XG5cbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhkYXRhLm9iamVjdFsncm9vbSddLmdldE5hbWUoKSk7IC8vIHJvb20gbmFtZVxuICAgICAgICAvLyB9KSAgXG4gICAgICAgIC8vIHRoaXMudmlkZW9BY3Rpdml0eS52aWRlb0V2ZW50Lm9uKCdvbkNvbm5lY3RGYWlsdXJlJywgKGRhdGEpID0+IHtcbiAgICAgICAgLy8gICAgIC8vIGxlYXZlIHJvb20uLiByZXF1ZXN0IG5ldyBtYXRjaFxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ29uQ29ubmVjdEZhaWx1cmUnKTtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUuZGlyKGRhdGEpO1xuICAgICAgICAvLyB9KSBcbiAgICAgICAgLy8gdGhpcy52aWRlb0FjdGl2aXR5LnZpZGVvRXZlbnQub24oJ29uRGlzY29ubmVjdGVkJywgKGRhdGEpID0+IHtcbiAgICAgICAgLy8gICAgIC8vIGxlYXZlIHJvb20uLiByZXF1ZXN0IG5ldyBtYXRjaFxuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ29uRGlzY29ubmVjdGVkJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgLy8gICAgIHRoaXMucGFydGljaXBhbnQgPSBkYXRhLm9iamVjdFsncGFydGljaXBhbnQnXS5nZXRJZGVudGl0eSgpO1xuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ29uRGlzY29ubmVjdGVkOiAnLCB0aGlzLnBhcnRpY2lwYW50KTtcbiAgICAgICAgLy8gfSkgXG4gICAgICAgIC8vIHRoaXMudmlkZW9BY3Rpdml0eS52aWRlb0V2ZW50Lm9uKCdvblBhcnRpY2lwYW50Q29ubmVjdGVkJywgKGRhdGEpID0+IHtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCdvblBhcnRpY2lwYW50Q29ubmVjdGVkJyk7XG4gICAgICAgIC8vICAgICB0aGlzLnBhcnRpY2lwYW50ID0gZGF0YS5vYmplY3RbJ3BhcnRpY2lwYW50J10uZ2V0SWRlbnRpdHkoKTtcbiAgICAgICAgLy8gICAgIHRoaXMuc2V0KCdwYXJ0aWNpcGFudCcsIGRhdGEub2JqZWN0WydwYXJ0aWNpcGFudCddLmdldElkZW50aXR5KCkpO1xuICAgICAgICAvLyB9KSBcbiAgICAgICAgLy8gdGhpcy52aWRlb0FjdGl2aXR5LnZpZGVvRXZlbnQub24oJ29uUGFydGljaXBhbnREaXNjb25uZWN0ZWQnLCAoZGF0YSkgPT4ge1xuICAgICAgICAvLyAgICAgLy8gbGVhdmUgcm9vbS4uIHJlcXVlc3QgbmV3IG1hdGNoXG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygnb25QYXJ0aWNpcGFudERpc2Nvbm5lY3RlZCcpO1xuICAgICAgICAvLyAgICAgdGhpcy5wYXJ0aWNpcGFudCA9IGRhdGEub2JqZWN0WydwYXJ0aWNpcGFudCddLmdldElkZW50aXR5KCk7XG4gICAgICAgIC8vIH0pIFxuICAgICAgICAvLyB0aGlzLnZpZGVvQWN0aXZpdHkudmlkZW9FdmVudC5vbignb25BdWRpb1RyYWNrQWRkZWQnLCAoZGF0YSkgPT4ge1xuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ29uQXVkaW9UcmFja0FkZGVkJyk7XG4gICAgICAgIC8vIH0pIFxuICAgICAgICAvLyB0aGlzLnZpZGVvQWN0aXZpdHkudmlkZW9FdmVudC5vbignb25BdWRpb1RyYWNrUmVtb3ZlZCcsIChkYXRhKSA9PiB7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygnb25BdWRpb1RyYWNrUmVtb3ZlZCcpO1xuICAgICAgICAvLyB9KSBcbiAgICAgICAgLy8gdGhpcy52aWRlb0FjdGl2aXR5LnZpZGVvRXZlbnQub24oJ29uVmlkZW9UcmFja0FkZGVkJywgKGRhdGEpID0+IHtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCdvblZpZGVvVHJhY2tBZGRlZCcpO1xuICAgICAgICAvLyB9KSBcbiAgICAgICAgLy8gdGhpcy52aWRlb0FjdGl2aXR5LnZpZGVvRXZlbnQub24oJ29uVmlkZW9UcmFja1JlbW92ZWQnLCAoZGF0YSkgPT4ge1xuICAgICAgICAvLyAgICAgY29uc29sZS5sb2coJ29uVmlkZW9UcmFja1JlbW92ZWQnKTtcbiAgICAgICAgLy8gfSkgIFxuICAgICAgICAvLyB0aGlzLnZpZGVvQWN0aXZpdHkudmlkZW9FdmVudC5vbignb25BdWRpb1RyYWNrRW5hYmxlZCcsIChkYXRhKSA9PiB7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygnb25BdWRpb1RyYWNrRW5hYmxlZCcpO1xuICAgICAgICAvLyB9KSAgXG4gICAgICAgIC8vIHRoaXMudmlkZW9BY3Rpdml0eS52aWRlb0V2ZW50Lm9uKCdvbkF1ZGlvVHJhY2tEaXNhYmxlZCcsIChkYXRhKSA9PiB7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZygnb25BdWRpb1RyYWNrRGlzYWJsZWQnKTtcbiAgICAgICAgLy8gfSkgXG4gICAgICAgIC8vIHRoaXMudmlkZW9BY3Rpdml0eS52aWRlb0V2ZW50Lm9uKCdvblZpZGVvVHJhY2tFbmFibGVkJywgKGRhdGEpID0+IHtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCdvblZpZGVvVHJhY2tFbmFibGVkJyk7XG4gICAgICAgIC8vIH0pICBcbiAgICAgICAgLy8gdGhpcy52aWRlb0FjdGl2aXR5LnZpZGVvRXZlbnQub24oJ29uVmlkZW9UcmFja0Rpc2FibGVkJywgKGRhdGEpID0+IHtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCdvblZpZGVvVHJhY2tEaXNhYmxlZCcpO1xuICAgICAgICAvLyB9KSAgICAgICAgICBcbiAgICAgICAgXG4gICAgfVxuXG5cblxuICAgIGdldFBlcm1pc3Npb25zKCk6IHZvaWQge1xuXG4gICAgICAgIHBlcm1pc3Npb25zLnJlcXVlc3RQZXJtaXNzaW9ucyhbXG4gICAgICAgICAgICBhbmRyb2lkLk1hbmlmZXN0LnBlcm1pc3Npb24uUkVDT1JEX0FVRElPLFxuICAgICAgICAgICAgYW5kcm9pZC5NYW5pZmVzdC5wZXJtaXNzaW9uLkNBTUVSQVxuICAgICAgICAgICAgXSwgXCJJIG5lZWQgdGhlc2UgcGVybWlzc2lvbnMgYmVjYXVzZSBJJ20gY29vbFwiKVxuICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kaXIoZSk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVaCBvaCwgbm8gcGVybWlzc2lvbnMgLSBwbGFuIEIgdGltZSFcIik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cblxuICAgIHB1YmxpYyBzaG93X2xvY2FsX3ZpZGVvKCkge1xuXG4gICAgICAgIHRoaXMudmlkZW9BY3Rpdml0eS5jcmVhdGVBdWRpb0FuZFZpZGVvVHJhY2tzKCk7XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgdG9nZ2xlX2xvY2FsX3ZpZGVvKCkge1xuXG4gICAgICAgIHRoaXMudmlkZW9BY3Rpdml0eS50b2dnbGVfbG9jYWxfdmlkZW8oKTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBzZXRfYWNjZXNzX3Rva2VuKHRva2VuOiBzdHJpbmcsIG5hbWU6IHN0cmluZykge1xuXG4gICAgICAgIHRoaXMudmlkZW9BY3Rpdml0eS5zZXRfYWNjZXNzX3Rva2VuKHRva2VuLCBuYW1lKTtcblxuICAgIH1cblxuXG4gICAgcHVibGljIGNvbm5lY3RfdG9fcm9vbShyb29tOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy52aWRlb0FjdGl2aXR5LmNvbm5lY3RfdG9fcm9vbSgnYScpOyAgICAgICAgXG4gICAgICAgIC8vIGh0dHAuZ2V0SlNPTignaHR0cDovL2FjODY1ZmYyLm5ncm9rLmlvL3Rva2VuJykudGhlbigocmVzKSA9PiB7XG4gICAgICAgIC8vICAgICB0aGlzLnNldCgnbmFtZScsIHJlcy5pZGVudGl0eSk7XG4gICAgICAgIC8vICAgICB0aGlzLnNldF9hY2Nlc3NfdG9rZW4ocmVzLnRva2VuLCByZXMuaWRlbnRpdHkpO1xuICAgICAgICAvLyAgICAgdGhpcy52aWRlb0FjdGl2aXR5LmNvbm5lY3RfdG9fcm9vbSgnYWFzc2JjZGFlZmdoYWlqc3NrbG0nKTtcbiAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCdoaXQnKTsgICAgICAgICAgXG4gICAgICAgIC8vIH0sIChlKSA9PiB7XG4gICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhlKTtcbiAgICAgICAgLy8gfSk7XG4gICAgICAgIFxuICAgIH1cblxuXG59Il19